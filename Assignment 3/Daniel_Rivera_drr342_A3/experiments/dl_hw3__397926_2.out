python /home/drr342/dl/assignments/hw3/examples/word_language_model/main.py --data /home/drr342/dl/assignments/hw3/examples/word_language_model/data/wikitext-2 --save /home/drr342/dl/assignments/hw3/models/LSTM'_'100'_'1'_'32.pt --cuda --model LSTM --epochs 10 --emsize 100 --nlayers 1 --bptt 32

/home/drr342/pyenv/py3.6.3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:46: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
| epoch   1 |   200/ 3263 batches | lr 20.00 | ms/batch 36.32 | loss  7.58 | ppl  1965.46
| epoch   1 |   400/ 3263 batches | lr 20.00 | ms/batch 35.64 | loss  6.71 | ppl   818.39
| epoch   1 |   600/ 3263 batches | lr 20.00 | ms/batch 35.65 | loss  6.35 | ppl   571.73
| epoch   1 |   800/ 3263 batches | lr 20.00 | ms/batch 35.73 | loss  6.13 | ppl   460.86
| epoch   1 |  1000/ 3263 batches | lr 20.00 | ms/batch 35.84 | loss  6.05 | ppl   425.16
| epoch   1 |  1200/ 3263 batches | lr 20.00 | ms/batch 35.88 | loss  5.98 | ppl   397.17
| epoch   1 |  1400/ 3263 batches | lr 20.00 | ms/batch 35.87 | loss  5.93 | ppl   376.57
| epoch   1 |  1600/ 3263 batches | lr 20.00 | ms/batch 35.84 | loss  5.85 | ppl   345.81
| epoch   1 |  1800/ 3263 batches | lr 20.00 | ms/batch 35.86 | loss  5.85 | ppl   348.70
| epoch   1 |  2000/ 3263 batches | lr 20.00 | ms/batch 35.94 | loss  5.73 | ppl   309.27
| epoch   1 |  2200/ 3263 batches | lr 20.00 | ms/batch 35.98 | loss  5.70 | ppl   298.19
| epoch   1 |  2400/ 3263 batches | lr 20.00 | ms/batch 35.97 | loss  5.61 | ppl   272.54
| epoch   1 |  2600/ 3263 batches | lr 20.00 | ms/batch 35.95 | loss  5.61 | ppl   272.87
| epoch   1 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.03 | loss  5.60 | ppl   271.16
| epoch   1 |  3000/ 3263 batches | lr 20.00 | ms/batch 35.95 | loss  5.54 | ppl   253.62
| epoch   1 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.03 | loss  5.46 | ppl   235.39
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 121.83s | valid loss  5.52 | valid ppl   249.12
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 3263 batches | lr 20.00 | ms/batch 36.20 | loss  5.51 | ppl   246.33
| epoch   2 |   400/ 3263 batches | lr 20.00 | ms/batch 36.08 | loss  5.49 | ppl   242.30
| epoch   2 |   600/ 3263 batches | lr 20.00 | ms/batch 36.05 | loss  5.38 | ppl   216.46
| epoch   2 |   800/ 3263 batches | lr 20.00 | ms/batch 36.07 | loss  5.28 | ppl   196.69
| epoch   2 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.08 | loss  5.34 | ppl   208.62
| epoch   2 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.09 | loss  5.29 | ppl   198.28
| epoch   2 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.12 | loss  5.33 | ppl   206.85
| epoch   2 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.10 | loss  5.29 | ppl   199.03
| epoch   2 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.14 | loss  5.34 | ppl   208.79
| epoch   2 |  2000/ 3263 batches | lr 20.00 | ms/batch 36.12 | loss  5.24 | ppl   189.60
| epoch   2 |  2200/ 3263 batches | lr 20.00 | ms/batch 36.16 | loss  5.24 | ppl   187.90
| epoch   2 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.13 | loss  5.16 | ppl   174.03
| epoch   2 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.09 | loss  5.17 | ppl   175.99
| epoch   2 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.15 | loss  5.18 | ppl   177.63
| epoch   2 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.13 | loss  5.16 | ppl   173.38
| epoch   2 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.21 | loss  5.08 | ppl   160.23
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 122.52s | valid loss  5.26 | valid ppl   192.35
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 3263 batches | lr 20.00 | ms/batch 36.30 | loss  5.17 | ppl   175.87
| epoch   3 |   400/ 3263 batches | lr 20.00 | ms/batch 36.18 | loss  5.18 | ppl   178.48
| epoch   3 |   600/ 3263 batches | lr 20.00 | ms/batch 36.19 | loss  5.07 | ppl   159.44
| epoch   3 |   800/ 3263 batches | lr 20.00 | ms/batch 36.30 | loss  5.00 | ppl   147.83
| epoch   3 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.23 | loss  5.07 | ppl   159.65
| epoch   3 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.19 | loss  5.02 | ppl   151.36
| epoch   3 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.23 | loss  5.09 | ppl   162.38
| epoch   3 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.28 | loss  5.06 | ppl   157.88
| epoch   3 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.27 | loss  5.11 | ppl   165.85
| epoch   3 |  2000/ 3263 batches | lr 20.00 | ms/batch 36.24 | loss  5.02 | ppl   151.88
| epoch   3 |  2200/ 3263 batches | lr 20.00 | ms/batch 36.20 | loss  5.03 | ppl   152.83
| epoch   3 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.22 | loss  4.94 | ppl   140.04
| epoch   3 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.25 | loss  4.96 | ppl   143.14
| epoch   3 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.24 | loss  4.97 | ppl   144.00
| epoch   3 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.27 | loss  4.97 | ppl   143.83
| epoch   3 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.35 | loss  4.89 | ppl   132.59
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 122.95s | valid loss  5.14 | valid ppl   170.22
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 3263 batches | lr 20.00 | ms/batch 36.38 | loss  4.98 | ppl   145.38
| epoch   4 |   400/ 3263 batches | lr 20.00 | ms/batch 36.28 | loss  5.01 | ppl   149.38
| epoch   4 |   600/ 3263 batches | lr 20.00 | ms/batch 36.30 | loss  4.90 | ppl   133.67
| epoch   4 |   800/ 3263 batches | lr 20.00 | ms/batch 36.31 | loss  4.83 | ppl   124.61
| epoch   4 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.38 | loss  4.91 | ppl   135.61
| epoch   4 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.38 | loss  4.86 | ppl   128.73
| epoch   4 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.28 | loss  4.94 | ppl   140.45
| epoch   4 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.38 | loss  4.91 | ppl   136.29
| epoch   4 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.28 | loss  4.97 | ppl   144.48
| epoch   4 |  2000/ 3263 batches | lr 20.00 | ms/batch 36.32 | loss  4.88 | ppl   132.01
| epoch   4 |  2200/ 3263 batches | lr 20.00 | ms/batch 36.35 | loss  4.89 | ppl   132.89
| epoch   4 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.44 | loss  4.80 | ppl   122.08
| epoch   4 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.82 | ppl   124.39
| epoch   4 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.44 | loss  4.84 | ppl   126.65
| epoch   4 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.36 | loss  4.84 | ppl   126.70
| epoch   4 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.51 | loss  4.76 | ppl   116.94
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 123.32s | valid loss  5.08 | valid ppl   160.82
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 3263 batches | lr 20.00 | ms/batch 36.65 | loss  4.86 | ppl   128.43
| epoch   5 |   400/ 3263 batches | lr 20.00 | ms/batch 36.45 | loss  4.88 | ppl   131.73
| epoch   5 |   600/ 3263 batches | lr 20.00 | ms/batch 36.73 | loss  4.77 | ppl   118.27
| epoch   5 |   800/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.71 | ppl   110.87
| epoch   5 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.65 | loss  4.80 | ppl   121.25
| epoch   5 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.53 | loss  4.75 | ppl   115.29
| epoch   5 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.50 | loss  4.84 | ppl   126.51
| epoch   5 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.58 | loss  4.81 | ppl   122.41
| epoch   5 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.77 | loss  4.86 | ppl   129.40
| epoch   5 |  2000/ 3263 batches | lr 20.00 | ms/batch 36.58 | loss  4.79 | ppl   119.75
| epoch   5 |  2200/ 3263 batches | lr 20.00 | ms/batch 36.62 | loss  4.79 | ppl   120.44
| epoch   5 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.74 | loss  4.70 | ppl   110.03
| epoch   5 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.48 | loss  4.72 | ppl   112.72
| epoch   5 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.59 | loss  4.75 | ppl   115.44
| epoch   5 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.69 | loss  4.75 | ppl   115.25
| epoch   5 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.80 | loss  4.67 | ppl   106.25
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 124.12s | valid loss  5.05 | valid ppl   156.19
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 3263 batches | lr 20.00 | ms/batch 36.65 | loss  4.76 | ppl   116.80
| epoch   6 |   400/ 3263 batches | lr 20.00 | ms/batch 36.64 | loss  4.79 | ppl   120.23
| epoch   6 |   600/ 3263 batches | lr 20.00 | ms/batch 36.53 | loss  4.68 | ppl   108.08
| epoch   6 |   800/ 3263 batches | lr 20.00 | ms/batch 36.46 | loss  4.62 | ppl   101.45
| epoch   6 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.60 | loss  4.71 | ppl   111.11
| epoch   6 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.54 | loss  4.67 | ppl   106.76
| epoch   6 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.77 | loss  4.76 | ppl   116.95
| epoch   6 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.72 | ppl   112.38
| epoch   6 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.69 | loss  4.79 | ppl   120.03
| epoch   6 |  2000/ 3263 batches | lr 20.00 | ms/batch 36.61 | loss  4.71 | ppl   111.17
| epoch   6 |  2200/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.71 | ppl   111.24
| epoch   6 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.94 | loss  4.62 | ppl   101.71
| epoch   6 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.85 | loss  4.65 | ppl   104.79
| epoch   6 |  2800/ 3263 batches | lr 20.00 | ms/batch 37.11 | loss  4.67 | ppl   107.19
| epoch   6 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.71 | loss  4.67 | ppl   107.19
| epoch   6 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.55 | loss  4.59 | ppl    98.96
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 124.26s | valid loss  5.03 | valid ppl   153.34
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 3263 batches | lr 20.00 | ms/batch 36.52 | loss  4.68 | ppl   107.93
| epoch   7 |   400/ 3263 batches | lr 20.00 | ms/batch 36.40 | loss  4.71 | ppl   110.83
| epoch   7 |   600/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.60 | ppl    99.95
| epoch   7 |   800/ 3263 batches | lr 20.00 | ms/batch 36.52 | loss  4.55 | ppl    94.59
| epoch   7 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.64 | ppl   103.57
| epoch   7 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.41 | loss  4.60 | ppl    99.41
| epoch   7 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.69 | ppl   109.25
| epoch   7 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.49 | loss  4.66 | ppl   105.31
| epoch   7 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.47 | loss  4.72 | ppl   112.36
| epoch   7 |  2000/ 3263 batches | lr 20.00 | ms/batch 37.09 | loss  4.64 | ppl   103.67
| epoch   7 |  2200/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.65 | ppl   104.56
| epoch   7 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.40 | loss  4.56 | ppl    95.16
| epoch   7 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.59 | ppl    98.05
| epoch   7 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.65 | loss  4.61 | ppl   100.04
| epoch   7 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.58 | loss  4.61 | ppl   100.51
| epoch   7 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.53 | ppl    93.16
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 123.79s | valid loss  5.02 | valid ppl   152.03
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 3263 batches | lr 20.00 | ms/batch 36.56 | loss  4.62 | ppl   101.32
| epoch   8 |   400/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.64 | ppl   103.95
| epoch   8 |   600/ 3263 batches | lr 20.00 | ms/batch 36.41 | loss  4.55 | ppl    94.59
| epoch   8 |   800/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.49 | ppl    89.27
| epoch   8 |  1000/ 3263 batches | lr 20.00 | ms/batch 36.45 | loss  4.59 | ppl    98.33
| epoch   8 |  1200/ 3263 batches | lr 20.00 | ms/batch 36.42 | loss  4.55 | ppl    94.35
| epoch   8 |  1400/ 3263 batches | lr 20.00 | ms/batch 36.46 | loss  4.64 | ppl   103.74
| epoch   8 |  1600/ 3263 batches | lr 20.00 | ms/batch 36.47 | loss  4.60 | ppl    99.17
| epoch   8 |  1800/ 3263 batches | lr 20.00 | ms/batch 36.43 | loss  4.67 | ppl   106.77
| epoch   8 |  2000/ 3263 batches | lr 20.00 | ms/batch 36.81 | loss  4.59 | ppl    98.57
| epoch   8 |  2200/ 3263 batches | lr 20.00 | ms/batch 37.56 | loss  4.60 | ppl    99.27
| epoch   8 |  2400/ 3263 batches | lr 20.00 | ms/batch 36.76 | loss  4.50 | ppl    90.27
| epoch   8 |  2600/ 3263 batches | lr 20.00 | ms/batch 36.40 | loss  4.54 | ppl    93.30
| epoch   8 |  2800/ 3263 batches | lr 20.00 | ms/batch 36.36 | loss  4.56 | ppl    95.49
| epoch   8 |  3000/ 3263 batches | lr 20.00 | ms/batch 36.39 | loss  4.56 | ppl    95.82
| epoch   8 |  3200/ 3263 batches | lr 20.00 | ms/batch 36.41 | loss  4.49 | ppl    88.83
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 123.91s | valid loss  5.03 | valid ppl   152.81
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 3263 batches | lr 5.00 | ms/batch 36.56 | loss  4.60 | ppl    99.44
| epoch   9 |   400/ 3263 batches | lr 5.00 | ms/batch 36.51 | loss  4.59 | ppl    98.04
| epoch   9 |   600/ 3263 batches | lr 5.00 | ms/batch 36.50 | loss  4.47 | ppl    87.73
| epoch   9 |   800/ 3263 batches | lr 5.00 | ms/batch 36.41 | loss  4.42 | ppl    82.79
| epoch   9 |  1000/ 3263 batches | lr 5.00 | ms/batch 36.38 | loss  4.49 | ppl    88.76
| epoch   9 |  1200/ 3263 batches | lr 5.00 | ms/batch 36.38 | loss  4.42 | ppl    82.97
| epoch   9 |  1400/ 3263 batches | lr 5.00 | ms/batch 36.42 | loss  4.50 | ppl    89.88
| epoch   9 |  1600/ 3263 batches | lr 5.00 | ms/batch 37.44 | loss  4.43 | ppl    84.33
| epoch   9 |  1800/ 3263 batches | lr 5.00 | ms/batch 37.50 | loss  4.50 | ppl    89.90
| epoch   9 |  2000/ 3263 batches | lr 5.00 | ms/batch 37.62 | loss  4.39 | ppl    81.00
| epoch   9 |  2200/ 3263 batches | lr 5.00 | ms/batch 37.60 | loss  4.40 | ppl    81.84
| epoch   9 |  2400/ 3263 batches | lr 5.00 | ms/batch 37.56 | loss  4.28 | ppl    72.18
| epoch   9 |  2600/ 3263 batches | lr 5.00 | ms/batch 37.47 | loss  4.29 | ppl    73.25
| epoch   9 |  2800/ 3263 batches | lr 5.00 | ms/batch 37.56 | loss  4.30 | ppl    73.64
| epoch   9 |  3000/ 3263 batches | lr 5.00 | ms/batch 37.41 | loss  4.29 | ppl    73.03
| epoch   9 |  3200/ 3263 batches | lr 5.00 | ms/batch 37.44 | loss  4.20 | ppl    66.92
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 125.57s | valid loss  4.89 | valid ppl   133.22
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 3263 batches | lr 5.00 | ms/batch 36.43 | loss  4.44 | ppl    84.61
| epoch  10 |   400/ 3263 batches | lr 5.00 | ms/batch 36.34 | loss  4.46 | ppl    86.38
| epoch  10 |   600/ 3263 batches | lr 5.00 | ms/batch 36.31 | loss  4.35 | ppl    77.63
| epoch  10 |   800/ 3263 batches | lr 5.00 | ms/batch 36.37 | loss  4.31 | ppl    74.17
| epoch  10 |  1000/ 3263 batches | lr 5.00 | ms/batch 36.34 | loss  4.38 | ppl    79.85
| epoch  10 |  1200/ 3263 batches | lr 5.00 | ms/batch 36.35 | loss  4.33 | ppl    76.02
| epoch  10 |  1400/ 3263 batches | lr 5.00 | ms/batch 36.30 | loss  4.42 | ppl    82.93
| epoch  10 |  1600/ 3263 batches | lr 5.00 | ms/batch 36.37 | loss  4.36 | ppl    78.37
| epoch  10 |  1800/ 3263 batches | lr 5.00 | ms/batch 36.34 | loss  4.42 | ppl    83.38
| epoch  10 |  2000/ 3263 batches | lr 5.00 | ms/batch 36.31 | loss  4.34 | ppl    76.53
| epoch  10 |  2200/ 3263 batches | lr 5.00 | ms/batch 36.36 | loss  4.35 | ppl    77.34
| epoch  10 |  2400/ 3263 batches | lr 5.00 | ms/batch 36.35 | loss  4.23 | ppl    68.89
| epoch  10 |  2600/ 3263 batches | lr 5.00 | ms/batch 36.34 | loss  4.25 | ppl    69.99
| epoch  10 |  2800/ 3263 batches | lr 5.00 | ms/batch 36.31 | loss  4.27 | ppl    71.34
| epoch  10 |  3000/ 3263 batches | lr 5.00 | ms/batch 36.32 | loss  4.27 | ppl    71.29
| epoch  10 |  3200/ 3263 batches | lr 5.00 | ms/batch 36.32 | loss  4.19 | ppl    65.92
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 123.24s | valid loss  4.88 | valid ppl   131.63
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  4.81 | test ppl   123.16
=========================================================================================
